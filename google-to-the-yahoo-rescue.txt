Yahoo had a profit miss for Q3, causing shares to drop, but there was a gem in the release that should make investors very happy.The company says that it reached a search agreement this month with search giant Google, CEO Marissa Mayers old stomping grounds. Its a three-year, non-exclusive agreement that covers both mobile and desktop audiences here and abroad.Heres the bit:In October, the Company reached an agreement with Google that provides Yahoo with additional flexibility to choose among suppliers of search results and ads. Googles offerings complement the search services provided by Microsoft, which remains a strong partner, as well as Yahoos own search technologies and ad products.$YHOO has signed a 3 year partnership with Google to bolster our search capabilities. This is in addition to our relationship with Microsoft Yahoo Inc. (@YahooInc) October 20, 2015Referring to Microsoft as a strong partner is a bit of lipservice, as reports have indicated that the company would like to get out of the deal it entered in 2009. It amended that deal to make way for this new Google agreement this year.Heres the interesting chunk from the regulatory filing on the agreement:Under the Services Agreement, Yahoo has discretion to select which search queries to send to Google and is not obligated to send any minimum number of search queries. The Services Agreement is non-exclusive and expressly permits Yahoo to use any other search advertising services, including its own service, the services of Microsoft Corporation or other third parties.Read the entire document below:While its highly unlikely that Yahoo will ever fully own its own search experience, it does have the chops to do so. Being able to pick and choose certain results or ad remnants from Google will help bring back value to its portal which sports that big search box that people still use. Yes, people still use it. In fact, they sometimes flirt with the #2 desktop search spot behind Google. Right now they sit at #3, with 12.7% share. Its not desktop they crave, thoughits mobile.Mobile search hasnt been completely nailed by anyone at this point, including Google. The company recently reported that mobile surpassed desktop searches for the first time, but theres no indication as to whether advertising is becoming healthier on mobile devices.Wrestling its results and ads away from Microsoft is key to evolving its own search products and making more money from them. Native ads have been the flavor of the Mayer regime and it would be interesting to see a Yahoo search experience, similar to the one that powers the acquired Tumblr.During the Q&A of the earnings call, Marissa Mayer was asked about the mechanics of the deal and how Microsoft fits in. She said were excited be announcing the partnership today and talked about how Yahoo will be learning about how to split up ads and results between its own, Google and Microsoft (and perhaps other players in the future), but didnt provide specifics. Mayer did state more than once that Yahoo remains bullish on its Gemini program.Mayer pointed out that stats say 90 percent of time on phones are spent in apps, not in the browser, so look for contextual experiences driven by apps and mobile initiatives like the acquired Android launcher Aviate.Weve reached out to both Google and Microsoft for comment on the new partnership and will update if we hear back.UPDATE: A Microsoft spokesperson sent us the following statement:We remain committed to the Yahoo syndication partnership and will continue to serve the majority of Yahoo traffic as outlined in our contract extension. Yahoo is a valued partner and we look forward to continuing to serve our advertising customers through the Bing Ads marketplace.